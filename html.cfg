\Preamble{xhtml}

\Configure{tableofcontents*}{chapter,section,subsection}

\Css{@media (max-width: 768px) {
  .layout {
    flex-direction: column;
  }
  aside.toc {
    position: relative;
    width: 100%;
    max-height: none;
    border-right: none;
    border-bottom: 1px solid \#ccc;
  }
}}

\Css{div.layout {
    display: flex;
    align-items: flex-start;
    gap: 2rem;
    max-width: 64rem;
    margin: 0 auto;
}}

\Css{aside.toc {
    position: sticky;
    top: 2rem;
    width: 16rem;
    height: max-content;
    max-height: 90vh;
    overflow-y: auto;
    padding: .2rem; 
    border-right: 1px solid \#ccc;
    font-size: .8rem;
    line-height: 1;
}}

\Css{aside span {
    display: block;
}}

\Css{main {
    flex: 1;
    padding: 0 2rem 1rem;
    min-width: 0;
}}


\Configure{tableofcontents}
    {\HCode{<div class="layout"><aside class="toc">}}
    {\HCode{</aside><main>}}

\Css{html {
    width: 100vw;
    overflow-x: hidden;
    scroll-behavior: smooth;
}}

\Css{@font-face {
  font-family: Manrope;
  src: url(Manrope_variable.ttf);
}}

\Css{body {
    box-sizing: border-box;
    padding: 1rem;
    margin: 0 auto;
    overflow-x: hidden;
    background-color: \#F4ECD8;
    color: \#5B464B;
    line-height: 1.5;
}}

\Css{img:first-of-type {
    width: 100%;
    max-width: 889px;
    display: block;
    margin: 0 auto 2rem;
    border-radius: 5px;
    box-shadow: 0 4px 8px rgba(0,0,0,0.1);
}}

\Css{a {
color: \#0060DF;
}}

\Css{p, a {
font-size: 1.2rem;
font-family: Manrope;
}}

\Css{p + pre {
font-size: 1.1em;
}}

\Css{div.author {
    white-space: normal;
}}

\Css{img.math {
    height: 1rem;
    vertical-align: top;
}}

\Css{pre.fancyvrb, {
    white-space: pre;
}}

\Css{figure, .fancyvrb, .verbatim {
    margin-inline: 0;
    overflow-x: auto;
}}

\Css{.ecrm-0500 {
    font-size: 70\%;
    font-style: italic;
    color: gray;
    width: 1.5rem;
    display: inline-block;
    -webkit-user-select: none;
    -moz-user-select: none;
    -o-user-select: none;
    user-select: none;
}}

\Css{.flushright:first-child {
    position:absolute;
    top: 10px;
    right: 50px;
}}

\Css{.right {
    text-align: right;
}}

\AtBeginDocument{%
\Configure{@HEAD}{\HCode{
    <script async defer src="https://buttons.github.io/buttons.js"></script>
    <div class="right">
        <a class="github-button" href="https://github.com/sysprog21/lkmpg" data-size="large" aria-label="View on GitHub">View on GitHub</a>
        <a class="github-button" href="https://github.com/sysprog21/lkmpg/releases/download/latest/lkmpg.pdf" data-icon="octicon-download" data-size="large" aria-label="Download PDF document">Download PDF document</a>
        <br><br>
    </div>
    \Hnewline}}
}

\begin{document}
\AtEndDocument{%
    \HCode{</main></div>}
}

\EndPreamble
